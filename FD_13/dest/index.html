<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Weather App</title>
  <link rel="stylesheet" href="output.css">
</head>
<body class="min-h-screen flex items-center justify-center bg-gray-200 transition-colors duration-500">
  <div class="bg-white p-8 rounded-lg shadow-lg w-full max-w-md">
    <h1 class="text-2xl font-bold text-center mb-4">Weather App</h1>
    <form id="weatherForm" class="flex gap-2 mb-4">
      <input type="text" id="cityInput" placeholder="Enter city name"
        class="flex-1 border border-gray-300 rounded px-4 py-2 focus:outline-none focus:ring-2 focus:ring-blue-400" required/>

      <button type="submit" class="bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600">
        Get Weather
      </button>
    
    </form>

    <div id="loading" class="hidden text-center my-4">
      <svg class="animate-spin h-8 w-8 text-blue-500 mx-auto" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
        <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
        <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8v8H4z"></path>
      </svg>
      <p class="mt-2 text-blue-500 font-medium">Loading...</p>
    </div>

    <div id="weatherResult" class="hidden text-center">
      <h2 id="cityName" class="text-xl font-semibold mb-2"></h2>
      <img id="weatherIcon" class="mx-auto mb-2" alt="Weather Icon" />
      <p id="temperature" class="text-3xl font-bold mb-2"></p>
      <p id="weatherCondition" class="text-lg text-gray-700"></p>
    </div>

    <div id="error" class="hidden text-red-500 text-center mt-4 font-medium"></div>
  </div>

  <script>
        const API_KEY = "be88bf47be33316de3f60dbfbfce01cc";

        const weatherForm = document.getElementById("weatherForm");
        const cityInput = document.getElementById("cityInput");
        const weatherResult = document.getElementById("weatherResult");
        const cityNameElem = document.getElementById("cityName");
        const temperatureElem = document.getElementById("temperature");
        const weatherConditionElem = document.getElementById("weatherCondition");
        const weatherIconElem = document.getElementById("weatherIcon");
        const errorElem = document.getElementById("error");
        const loadingElem = document.getElementById("loading");
        const body = document.querySelector("body");

        weatherForm.addEventListener("submit", async (e) => {
        e.preventDefault();
        const city = cityInput.value.toLowerCase();
        if (city) {
            fetchWeather(city);
        }
        });

        window.addEventListener("load", () => {
        const lastCity = localStorage.getItem("lastCity");
        if (lastCity) {
            fetchWeather(lastCity);
        }
        });

        async function fetchWeather(city) {
    errorElem.classList.add("hidden");
    weatherResult.classList.add("hidden");
    loadingElem.classList.remove("hidden");

    try {
        const response = await fetch(
        `https://api.openweathermap.org/data/2.5/weather?q=${city}&appid=${API_KEY}&units=metric`
        );

        if (!response.ok) {
        throw new Error("City not found");
        }

        const data = await response.json();

        cityNameElem.textContent = data.name;
        temperatureElem.textContent = `${Math.round(data.main.temp)}Â°C`;
        weatherConditionElem.textContent = data.weather.main;
        const iconCode = data.weather[0].icon;
        weatherIconElem.src = `https://openweathermap.org/img/wn/${iconCode}@2x.png`;

        updateBackground(data.weather[0].main);

        weatherResult.classList.remove("hidden");
        localStorage.setItem("lastCity", city);
    } 
    
    catch (error) {
        errorElem.textContent = error.message;
        errorElem.classList.remove("hidden");
    } 
    finally {
        loadingElem.classList.add("hidden");
    }
    }

    function updateBackground(condition) {
    let bgColor;
    let gradient;

    switch (condition.toLowerCase()) {
        case "clear":
        gradient = "bg-gradient-to-br from-yellow-200 via-yellow-400 to-yellow-600";
        break;
        case "clouds":
        gradient = "bg-gradient-to-br from-gray-300 via-gray-400 to-gray-700";
        break;
        case "rain":
        case "drizzle":
        gradient = "bg-gradient-to-br from-blue-200 via-blue-400 to-blue-700";
        break;
        case "snow":
        gradient = "bg-gradient-to-br from-white via-gray-200 to-gray-400";
        break;
        case "thunderstorm":
        gradient = "bg-gradient-to-br from-purple-300 via-purple-500 to-purple-700";
        break;
        default:
        gradient = "bg-gradient-to-br from-gray-200 via-gray-400 to-gray-600";
        break;
    }

    body.className = `min-h-screen flex items-center justify-center transition-colors duration-500 ${gradient}`;
}

  </script>
</body>
</html>
